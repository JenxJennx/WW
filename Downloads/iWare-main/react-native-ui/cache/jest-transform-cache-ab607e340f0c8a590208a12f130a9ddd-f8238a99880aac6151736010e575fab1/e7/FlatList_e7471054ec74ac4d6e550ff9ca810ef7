19d0742c67d126f61a1e1e1f4c5abc0f
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _VirtualizeUtils = require("./VirtualizeUtils");

var _jsxRuntime = require("react/jsx-runtime");

var _excluded = ["numColumns", "columnWrapperStyle", "removeClippedSubviews"];

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var Platform = require("../Utilities/Platform");

var deepDiffer = require("../Utilities/differ/deepDiffer");

var React = require('react');

var View = require("../Components/View/View");

var VirtualizedList = require("./VirtualizedList");

var StyleSheet = require("../StyleSheet/StyleSheet");

var invariant = require('invariant');

function removeClippedSubviewsOrDefault(removeClippedSubviews) {
  return removeClippedSubviews != null ? removeClippedSubviews : Platform.OS === 'android';
}

function numColumnsOrDefault(numColumns) {
  return numColumns != null ? numColumns : 1;
}

var FlatList = function (_React$PureComponent) {
  (0, _inherits2.default)(FlatList, _React$PureComponent);

  var _super = _createSuper(FlatList);

  function FlatList(_props) {
    var _this;

    (0, _classCallCheck2.default)(this, FlatList);
    _this = _super.call(this, _props);
    _this._virtualizedListPairs = [];

    _this._captureRef = function (ref) {
      _this._listRef = ref;
    };

    _this._getItem = function (data, index) {
      var numColumns = numColumnsOrDefault(_this.props.numColumns);

      if (numColumns > 1) {
        var ret = [];

        for (var kk = 0; kk < numColumns; kk++) {
          var _item = data[index * numColumns + kk];

          if (_item != null) {
            ret.push(_item);
          }
        }

        return ret;
      } else {
        return data[index];
      }
    };

    _this._getItemCount = function (data) {
      if (data) {
        var numColumns = numColumnsOrDefault(_this.props.numColumns);
        return numColumns > 1 ? Math.ceil(data.length / numColumns) : data.length;
      } else {
        return 0;
      }
    };

    _this._keyExtractor = function (items, index) {
      var _this$props$keyExtrac;

      var numColumns = numColumnsOrDefault(_this.props.numColumns);
      var keyExtractor = (_this$props$keyExtrac = _this.props.keyExtractor) != null ? _this$props$keyExtrac : _VirtualizeUtils.keyExtractor;

      if (numColumns > 1) {
        if (Array.isArray(items)) {
          return items.map(function (item, kk) {
            return keyExtractor(item, index * numColumns + kk);
          }).join(':');
        } else {
          invariant(Array.isArray(items), 'FlatList: Encountered internal consistency error, expected each item to consist of an ' + 'array with 1-%s columns; instead, received a single item.', numColumns);
        }
      } else {
        return keyExtractor(items, index);
      }
    };

    _this._renderer = function () {
      var _this$props = _this.props,
          ListItemComponent = _this$props.ListItemComponent,
          renderItem = _this$props.renderItem,
          columnWrapperStyle = _this$props.columnWrapperStyle;
      var numColumns = numColumnsOrDefault(_this.props.numColumns);
      var virtualizedListRenderKey = ListItemComponent ? 'ListItemComponent' : 'renderItem';

      var renderer = function renderer(props) {
        if (ListItemComponent) {
          return (0, _jsxRuntime.jsx)(ListItemComponent, _objectSpread({}, props));
        } else if (renderItem) {
          return renderItem(props);
        } else {
          return null;
        }
      };

      return (0, _defineProperty2.default)({}, virtualizedListRenderKey, function (info) {
        if (numColumns > 1) {
          var _item2 = info.item,
              _index = info.index;
          invariant(Array.isArray(_item2), 'Expected array of items with numColumns > 1');
          return (0, _jsxRuntime.jsx)(View, {
            style: StyleSheet.compose(styles.row, columnWrapperStyle),
            children: _item2.map(function (it, kk) {
              var element = renderer({
                item: it,
                index: _index * numColumns + kk,
                separators: info.separators
              });
              return element != null ? (0, _jsxRuntime.jsx)(React.Fragment, {
                children: element
              }, kk) : null;
            })
          });
        } else {
          return renderer(info);
        }
      });
    };

    _this._checkProps(_this.props);

    if (_this.props.viewabilityConfigCallbackPairs) {
      _this._virtualizedListPairs = _this.props.viewabilityConfigCallbackPairs.map(function (pair) {
        return {
          viewabilityConfig: pair.viewabilityConfig,
          onViewableItemsChanged: _this._createOnViewableItemsChanged(pair.onViewableItemsChanged)
        };
      });
    } else if (_this.props.onViewableItemsChanged) {
      _this._virtualizedListPairs.push({
        viewabilityConfig: _this.props.viewabilityConfig,
        onViewableItemsChanged: _this._createOnViewableItemsChanged(_this.props.onViewableItemsChanged)
      });
    }

    return _this;
  }

  (0, _createClass2.default)(FlatList, [{
    key: "scrollToEnd",
    value: function scrollToEnd(params) {
      if (this._listRef) {
        this._listRef.scrollToEnd(params);
      }
    }
  }, {
    key: "scrollToIndex",
    value: function scrollToIndex(params) {
      if (this._listRef) {
        this._listRef.scrollToIndex(params);
      }
    }
  }, {
    key: "scrollToItem",
    value: function scrollToItem(params) {
      if (this._listRef) {
        this._listRef.scrollToItem(params);
      }
    }
  }, {
    key: "scrollToOffset",
    value: function scrollToOffset(params) {
      if (this._listRef) {
        this._listRef.scrollToOffset(params);
      }
    }
  }, {
    key: "recordInteraction",
    value: function recordInteraction() {
      if (this._listRef) {
        this._listRef.recordInteraction();
      }
    }
  }, {
    key: "flashScrollIndicators",
    value: function flashScrollIndicators() {
      if (this._listRef) {
        this._listRef.flashScrollIndicators();
      }
    }
  }, {
    key: "getScrollResponder",
    value: function getScrollResponder() {
      if (this._listRef) {
        return this._listRef.getScrollResponder();
      }
    }
  }, {
    key: "getNativeScrollRef",
    value: function getNativeScrollRef() {
      if (this._listRef) {
        return this._listRef.getScrollRef();
      }
    }
  }, {
    key: "getScrollableNode",
    value: function getScrollableNode() {
      if (this._listRef) {
        return this._listRef.getScrollableNode();
      }
    }
  }, {
    key: "setNativeProps",
    value: function setNativeProps(props) {
      if (this._listRef) {
        this._listRef.setNativeProps(props);
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      invariant(prevProps.numColumns === this.props.numColumns, 'Changing numColumns on the fly is not supported. Change the key prop on FlatList when ' + 'changing the number of columns to force a fresh render of the component.');
      invariant(prevProps.onViewableItemsChanged === this.props.onViewableItemsChanged, 'Changing onViewableItemsChanged on the fly is not supported');
      invariant(!deepDiffer(prevProps.viewabilityConfig, this.props.viewabilityConfig), 'Changing viewabilityConfig on the fly is not supported');
      invariant(prevProps.viewabilityConfigCallbackPairs === this.props.viewabilityConfigCallbackPairs, 'Changing viewabilityConfigCallbackPairs on the fly is not supported');

      this._checkProps(this.props);
    }
  }, {
    key: "_checkProps",
    value: function _checkProps(props) {
      var getItem = props.getItem,
          getItemCount = props.getItemCount,
          horizontal = props.horizontal,
          columnWrapperStyle = props.columnWrapperStyle,
          onViewableItemsChanged = props.onViewableItemsChanged,
          viewabilityConfigCallbackPairs = props.viewabilityConfigCallbackPairs;
      var numColumns = numColumnsOrDefault(this.props.numColumns);
      invariant(!getItem && !getItemCount, 'FlatList does not support custom data formats.');

      if (numColumns > 1) {
        invariant(!horizontal, 'numColumns does not support horizontal.');
      } else {
        invariant(!columnWrapperStyle, 'columnWrapperStyle not supported for single column lists');
      }

      invariant(!(onViewableItemsChanged && viewabilityConfigCallbackPairs), 'FlatList does not support setting both onViewableItemsChanged and ' + 'viewabilityConfigCallbackPairs.');
    }
  }, {
    key: "_pushMultiColumnViewable",
    value: function _pushMultiColumnViewable(arr, v) {
      var _this$props$keyExtrac2;

      var numColumns = numColumnsOrDefault(this.props.numColumns);
      var keyExtractor = (_this$props$keyExtrac2 = this.props.keyExtractor) != null ? _this$props$keyExtrac2 : _VirtualizeUtils.keyExtractor;
      v.item.forEach(function (item, ii) {
        invariant(v.index != null, 'Missing index!');
        var index = v.index * numColumns + ii;
        arr.push(_objectSpread(_objectSpread({}, v), {}, {
          item: item,
          key: keyExtractor(item, index),
          index: index
        }));
      });
    }
  }, {
    key: "_createOnViewableItemsChanged",
    value: function _createOnViewableItemsChanged(onViewableItemsChanged) {
      var _this2 = this;

      return function (info) {
        var numColumns = numColumnsOrDefault(_this2.props.numColumns);

        if (onViewableItemsChanged) {
          if (numColumns > 1) {
            var changed = [];
            var viewableItems = [];
            info.viewableItems.forEach(function (v) {
              return _this2._pushMultiColumnViewable(viewableItems, v);
            });
            info.changed.forEach(function (v) {
              return _this2._pushMultiColumnViewable(changed, v);
            });
            onViewableItemsChanged({
              viewableItems: viewableItems,
              changed: changed
            });
          } else {
            onViewableItemsChanged(info);
          }
        }
      };
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props2 = this.props,
          numColumns = _this$props2.numColumns,
          columnWrapperStyle = _this$props2.columnWrapperStyle,
          _removeClippedSubviews = _this$props2.removeClippedSubviews,
          restProps = (0, _objectWithoutProperties2.default)(_this$props2, _excluded);
      return (0, _jsxRuntime.jsx)(VirtualizedList, _objectSpread(_objectSpread({}, restProps), {}, {
        getItem: this._getItem,
        getItemCount: this._getItemCount,
        keyExtractor: this._keyExtractor,
        ref: this._captureRef,
        viewabilityConfigCallbackPairs: this._virtualizedListPairs,
        removeClippedSubviews: removeClippedSubviewsOrDefault(_removeClippedSubviews)
      }, this._renderer()));
    }
  }]);
  return FlatList;
}(React.PureComponent);

var styles = StyleSheet.create({
  row: {
    flexDirection: 'row'
  }
});
module.exports = FlatList;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQbGF0Zm9ybSIsInJlcXVpcmUiLCJkZWVwRGlmZmVyIiwiUmVhY3QiLCJWaWV3IiwiVmlydHVhbGl6ZWRMaXN0IiwiU3R5bGVTaGVldCIsImludmFyaWFudCIsInJlbW92ZUNsaXBwZWRTdWJ2aWV3c09yRGVmYXVsdCIsInJlbW92ZUNsaXBwZWRTdWJ2aWV3cyIsIk9TIiwibnVtQ29sdW1uc09yRGVmYXVsdCIsIm51bUNvbHVtbnMiLCJGbGF0TGlzdCIsInByb3BzIiwiX3ZpcnR1YWxpemVkTGlzdFBhaXJzIiwiX2NhcHR1cmVSZWYiLCJyZWYiLCJfbGlzdFJlZiIsIl9nZXRJdGVtIiwiZGF0YSIsImluZGV4IiwicmV0Iiwia2siLCJpdGVtIiwicHVzaCIsIl9nZXRJdGVtQ291bnQiLCJNYXRoIiwiY2VpbCIsImxlbmd0aCIsIl9rZXlFeHRyYWN0b3IiLCJpdGVtcyIsImtleUV4dHJhY3RvciIsImRlZmF1bHRLZXlFeHRyYWN0b3IiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJqb2luIiwiX3JlbmRlcmVyIiwiTGlzdEl0ZW1Db21wb25lbnQiLCJyZW5kZXJJdGVtIiwiY29sdW1uV3JhcHBlclN0eWxlIiwidmlydHVhbGl6ZWRMaXN0UmVuZGVyS2V5IiwicmVuZGVyZXIiLCJpbmZvIiwiY29tcG9zZSIsInN0eWxlcyIsInJvdyIsIml0IiwiZWxlbWVudCIsInNlcGFyYXRvcnMiLCJfY2hlY2tQcm9wcyIsInZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyIsInBhaXIiLCJ2aWV3YWJpbGl0eUNvbmZpZyIsIm9uVmlld2FibGVJdGVtc0NoYW5nZWQiLCJfY3JlYXRlT25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCIsInBhcmFtcyIsInNjcm9sbFRvRW5kIiwic2Nyb2xsVG9JbmRleCIsInNjcm9sbFRvSXRlbSIsInNjcm9sbFRvT2Zmc2V0IiwicmVjb3JkSW50ZXJhY3Rpb24iLCJmbGFzaFNjcm9sbEluZGljYXRvcnMiLCJnZXRTY3JvbGxSZXNwb25kZXIiLCJnZXRTY3JvbGxSZWYiLCJnZXRTY3JvbGxhYmxlTm9kZSIsInNldE5hdGl2ZVByb3BzIiwicHJldlByb3BzIiwiZ2V0SXRlbSIsImdldEl0ZW1Db3VudCIsImhvcml6b250YWwiLCJhcnIiLCJ2IiwiZm9yRWFjaCIsImlpIiwia2V5IiwiY2hhbmdlZCIsInZpZXdhYmxlSXRlbXMiLCJfcHVzaE11bHRpQ29sdW1uVmlld2FibGUiLCJfcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzIiwicmVzdFByb3BzIiwiUHVyZUNvbXBvbmVudCIsImNyZWF0ZSIsImZsZXhEaXJlY3Rpb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiRmxhdExpc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCcuLi9VdGlsaXRpZXMvUGxhdGZvcm0nKTtcbmNvbnN0IGRlZXBEaWZmZXIgPSByZXF1aXJlKCcuLi9VdGlsaXRpZXMvZGlmZmVyL2RlZXBEaWZmZXInKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbmNvbnN0IFZpZXcgPSByZXF1aXJlKCcuLi9Db21wb25lbnRzL1ZpZXcvVmlldycpO1xuY29uc3QgVmlydHVhbGl6ZWRMaXN0ID0gcmVxdWlyZSgnLi9WaXJ0dWFsaXplZExpc3QnKTtcbmNvbnN0IFN0eWxlU2hlZXQgPSByZXF1aXJlKCcuLi9TdHlsZVNoZWV0L1N0eWxlU2hlZXQnKTtcblxuY29uc3QgaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG5cbmltcG9ydCB0eXBlb2YgU2Nyb2xsVmlld05hdGl2ZUNvbXBvbmVudCBmcm9tICcuLi9Db21wb25lbnRzL1Njcm9sbFZpZXcvU2Nyb2xsVmlld05hdGl2ZUNvbXBvbmVudCc7XG5pbXBvcnQge3R5cGUgU2Nyb2xsUmVzcG9uZGVyVHlwZX0gZnJvbSAnLi4vQ29tcG9uZW50cy9TY3JvbGxWaWV3L1Njcm9sbFZpZXcnO1xuaW1wb3J0IHR5cGUge1ZpZXdTdHlsZVByb3B9IGZyb20gJy4uL1N0eWxlU2hlZXQvU3R5bGVTaGVldCc7XG5pbXBvcnQgdHlwZSB7XG4gIFZpZXdUb2tlbixcbiAgVmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXIsXG59IGZyb20gJy4vVmlld2FiaWxpdHlIZWxwZXInO1xuaW1wb3J0IHR5cGUge1JlbmRlckl0ZW1UeXBlLCBSZW5kZXJJdGVtUHJvcHN9IGZyb20gJy4vVmlydHVhbGl6ZWRMaXN0JztcbmltcG9ydCB7a2V5RXh0cmFjdG9yIGFzIGRlZmF1bHRLZXlFeHRyYWN0b3J9IGZyb20gJy4vVmlydHVhbGl6ZVV0aWxzJztcblxudHlwZSBSZXF1aXJlZFByb3BzPEl0ZW1UPiA9IHt8XG4gIC8qKlxuICAgKiBGb3Igc2ltcGxpY2l0eSwgZGF0YSBpcyBqdXN0IGEgcGxhaW4gYXJyYXkuIElmIHlvdSB3YW50IHRvIHVzZSBzb21ldGhpbmcgZWxzZSwgbGlrZSBhblxuICAgKiBpbW11dGFibGUgbGlzdCwgdXNlIHRoZSB1bmRlcmx5aW5nIGBWaXJ0dWFsaXplZExpc3RgIGRpcmVjdGx5LlxuICAgKi9cbiAgZGF0YTogPyRSZWFkT25seUFycmF5PEl0ZW1UPixcbnx9O1xudHlwZSBPcHRpb25hbFByb3BzPEl0ZW1UPiA9IHt8XG4gIC8qKlxuICAgKiBUYWtlcyBhbiBpdGVtIGZyb20gYGRhdGFgIGFuZCByZW5kZXJzIGl0IGludG8gdGhlIGxpc3QuIEV4YW1wbGUgdXNhZ2U6XG4gICAqXG4gICAqICAgICA8RmxhdExpc3RcbiAgICogICAgICAgSXRlbVNlcGFyYXRvckNvbXBvbmVudD17UGxhdGZvcm0uT1MgIT09ICdhbmRyb2lkJyAmJiAoe2hpZ2hsaWdodGVkfSkgPT4gKFxuICAgKiAgICAgICAgIDxWaWV3IHN0eWxlPXtbc3R5bGUuc2VwYXJhdG9yLCBoaWdobGlnaHRlZCAmJiB7bWFyZ2luTGVmdDogMH1dfSAvPlxuICAgKiAgICAgICApfVxuICAgKiAgICAgICBkYXRhPXtbe3RpdGxlOiAnVGl0bGUgVGV4dCcsIGtleTogJ2l0ZW0xJ31dfVxuICAgKiAgICAgICByZW5kZXJJdGVtPXsoe2l0ZW0sIHNlcGFyYXRvcnN9KSA9PiAoXG4gICAqICAgICAgICAgPFRvdWNoYWJsZUhpZ2hsaWdodFxuICAgKiAgICAgICAgICAgb25QcmVzcz17KCkgPT4gdGhpcy5fb25QcmVzcyhpdGVtKX1cbiAgICogICAgICAgICAgIG9uU2hvd1VuZGVybGF5PXtzZXBhcmF0b3JzLmhpZ2hsaWdodH1cbiAgICogICAgICAgICAgIG9uSGlkZVVuZGVybGF5PXtzZXBhcmF0b3JzLnVuaGlnaGxpZ2h0fT5cbiAgICogICAgICAgICAgIDxWaWV3IHN0eWxlPXt7YmFja2dyb3VuZENvbG9yOiAnd2hpdGUnfX0+XG4gICAqICAgICAgICAgICAgIDxUZXh0PntpdGVtLnRpdGxlfTwvVGV4dD5cbiAgICogICAgICAgICAgIDwvVmlldz5cbiAgICogICAgICAgICA8L1RvdWNoYWJsZUhpZ2hsaWdodD5cbiAgICogICAgICAgKX1cbiAgICogICAgIC8+XG4gICAqXG4gICAqIFByb3ZpZGVzIGFkZGl0aW9uYWwgbWV0YWRhdGEgbGlrZSBgaW5kZXhgIGlmIHlvdSBuZWVkIGl0LCBhcyB3ZWxsIGFzIGEgbW9yZSBnZW5lcmljXG4gICAqIGBzZXBhcmF0b3JzLnVwZGF0ZVByb3BzYCBmdW5jdGlvbiB3aGljaCBsZXQncyB5b3Ugc2V0IHdoYXRldmVyIHByb3BzIHlvdSB3YW50IHRvIGNoYW5nZSB0aGVcbiAgICogcmVuZGVyaW5nIG9mIGVpdGhlciB0aGUgbGVhZGluZyBzZXBhcmF0b3Igb3IgdHJhaWxpbmcgc2VwYXJhdG9yIGluIGNhc2UgdGhlIG1vcmUgY29tbW9uXG4gICAqIGBoaWdobGlnaHRgIGFuZCBgdW5oaWdobGlnaHRgICh3aGljaCBzZXQgdGhlIGBoaWdobGlnaHRlZDogYm9vbGVhbmAgcHJvcCkgYXJlIGluc3VmZmljaWVudCBmb3JcbiAgICogeW91ciB1c2UtY2FzZS5cbiAgICovXG4gIHJlbmRlckl0ZW0/OiA/UmVuZGVySXRlbVR5cGU8SXRlbVQ+LFxuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBjdXN0b20gc3R5bGUgZm9yIG11bHRpLWl0ZW0gcm93cyBnZW5lcmF0ZWQgd2hlbiBudW1Db2x1bW5zID4gMS5cbiAgICovXG4gIGNvbHVtbldyYXBwZXJTdHlsZT86IFZpZXdTdHlsZVByb3AsXG4gIC8qKlxuICAgKiBBIG1hcmtlciBwcm9wZXJ0eSBmb3IgdGVsbGluZyB0aGUgbGlzdCB0byByZS1yZW5kZXIgKHNpbmNlIGl0IGltcGxlbWVudHMgYFB1cmVDb21wb25lbnRgKS4gSWZcbiAgICogYW55IG9mIHlvdXIgYHJlbmRlckl0ZW1gLCBIZWFkZXIsIEZvb3RlciwgZXRjLiBmdW5jdGlvbnMgZGVwZW5kIG9uIGFueXRoaW5nIG91dHNpZGUgb2YgdGhlXG4gICAqIGBkYXRhYCBwcm9wLCBzdGljayBpdCBoZXJlIGFuZCB0cmVhdCBpdCBpbW11dGFibHkuXG4gICAqL1xuICBleHRyYURhdGE/OiBhbnksXG4gIC8qKlxuICAgKiBgZ2V0SXRlbUxheW91dGAgaXMgYW4gb3B0aW9uYWwgb3B0aW1pemF0aW9ucyB0aGF0IGxldCB1cyBza2lwIG1lYXN1cmVtZW50IG9mIGR5bmFtaWMgY29udGVudCBpZlxuICAgKiB5b3Uga25vdyB0aGUgaGVpZ2h0IG9mIGl0ZW1zIGEgcHJpb3JpLiBgZ2V0SXRlbUxheW91dGAgaXMgdGhlIG1vc3QgZWZmaWNpZW50LCBhbmQgaXMgZWFzeSB0b1xuICAgKiB1c2UgaWYgeW91IGhhdmUgZml4ZWQgaGVpZ2h0IGl0ZW1zLCBmb3IgZXhhbXBsZTpcbiAgICpcbiAgICogICAgIGdldEl0ZW1MYXlvdXQ9eyhkYXRhLCBpbmRleCkgPT4gKFxuICAgKiAgICAgICB7bGVuZ3RoOiBJVEVNX0hFSUdIVCwgb2Zmc2V0OiBJVEVNX0hFSUdIVCAqIGluZGV4LCBpbmRleH1cbiAgICogICAgICl9XG4gICAqXG4gICAqIEFkZGluZyBgZ2V0SXRlbUxheW91dGAgY2FuIGJlIGEgZ3JlYXQgcGVyZm9ybWFuY2UgYm9vc3QgZm9yIGxpc3RzIG9mIHNldmVyYWwgaHVuZHJlZCBpdGVtcy5cbiAgICogUmVtZW1iZXIgdG8gaW5jbHVkZSBzZXBhcmF0b3IgbGVuZ3RoIChoZWlnaHQgb3Igd2lkdGgpIGluIHlvdXIgb2Zmc2V0IGNhbGN1bGF0aW9uIGlmIHlvdVxuICAgKiBzcGVjaWZ5IGBJdGVtU2VwYXJhdG9yQ29tcG9uZW50YC5cbiAgICovXG4gIGdldEl0ZW1MYXlvdXQ/OiAoXG4gICAgZGF0YTogP0FycmF5PEl0ZW1UPixcbiAgICBpbmRleDogbnVtYmVyLFxuICApID0+IHtcbiAgICBsZW5ndGg6IG51bWJlcixcbiAgICBvZmZzZXQ6IG51bWJlcixcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIC4uLlxuICB9LFxuICAvKipcbiAgICogSWYgdHJ1ZSwgcmVuZGVycyBpdGVtcyBuZXh0IHRvIGVhY2ggb3RoZXIgaG9yaXpvbnRhbGx5IGluc3RlYWQgb2Ygc3RhY2tlZCB2ZXJ0aWNhbGx5LlxuICAgKi9cbiAgaG9yaXpvbnRhbD86ID9ib29sZWFuLFxuICAvKipcbiAgICogSG93IG1hbnkgaXRlbXMgdG8gcmVuZGVyIGluIHRoZSBpbml0aWFsIGJhdGNoLiBUaGlzIHNob3VsZCBiZSBlbm91Z2ggdG8gZmlsbCB0aGUgc2NyZWVuIGJ1dCBub3RcbiAgICogbXVjaCBtb3JlLiBOb3RlIHRoZXNlIGl0ZW1zIHdpbGwgbmV2ZXIgYmUgdW5tb3VudGVkIGFzIHBhcnQgb2YgdGhlIHdpbmRvd2VkIHJlbmRlcmluZyBpbiBvcmRlclxuICAgKiB0byBpbXByb3ZlIHBlcmNlaXZlZCBwZXJmb3JtYW5jZSBvZiBzY3JvbGwtdG8tdG9wIGFjdGlvbnMuXG4gICAqL1xuICBpbml0aWFsTnVtVG9SZW5kZXI/OiA/bnVtYmVyLFxuICAvKipcbiAgICogSW5zdGVhZCBvZiBzdGFydGluZyBhdCB0aGUgdG9wIHdpdGggdGhlIGZpcnN0IGl0ZW0sIHN0YXJ0IGF0IGBpbml0aWFsU2Nyb2xsSW5kZXhgLiBUaGlzXG4gICAqIGRpc2FibGVzIHRoZSBcInNjcm9sbCB0byB0b3BcIiBvcHRpbWl6YXRpb24gdGhhdCBrZWVwcyB0aGUgZmlyc3QgYGluaXRpYWxOdW1Ub1JlbmRlcmAgaXRlbXNcbiAgICogYWx3YXlzIHJlbmRlcmVkIGFuZCBpbW1lZGlhdGVseSByZW5kZXJzIHRoZSBpdGVtcyBzdGFydGluZyBhdCB0aGlzIGluaXRpYWwgaW5kZXguIFJlcXVpcmVzXG4gICAqIGBnZXRJdGVtTGF5b3V0YCB0byBiZSBpbXBsZW1lbnRlZC5cbiAgICovXG4gIGluaXRpYWxTY3JvbGxJbmRleD86ID9udW1iZXIsXG4gIC8qKlxuICAgKiBSZXZlcnNlcyB0aGUgZGlyZWN0aW9uIG9mIHNjcm9sbC4gVXNlcyBzY2FsZSB0cmFuc2Zvcm1zIG9mIC0xLlxuICAgKi9cbiAgaW52ZXJ0ZWQ/OiA/Ym9vbGVhbixcbiAgLyoqXG4gICAqIFVzZWQgdG8gZXh0cmFjdCBhIHVuaXF1ZSBrZXkgZm9yIGEgZ2l2ZW4gaXRlbSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LiBLZXkgaXMgdXNlZCBmb3IgY2FjaGluZ1xuICAgKiBhbmQgYXMgdGhlIHJlYWN0IGtleSB0byB0cmFjayBpdGVtIHJlLW9yZGVyaW5nLiBUaGUgZGVmYXVsdCBleHRyYWN0b3IgY2hlY2tzIGBpdGVtLmtleWAsIHRoZW5cbiAgICogZmFsbHMgYmFjayB0byB1c2luZyB0aGUgaW5kZXgsIGxpa2UgUmVhY3QgZG9lcy5cbiAgICovXG4gIGtleUV4dHJhY3Rvcj86ID8oaXRlbTogSXRlbVQsIGluZGV4OiBudW1iZXIpID0+IHN0cmluZyxcbiAgLyoqXG4gICAqIE11bHRpcGxlIGNvbHVtbnMgY2FuIG9ubHkgYmUgcmVuZGVyZWQgd2l0aCBgaG9yaXpvbnRhbD17ZmFsc2V9YCBhbmQgd2lsbCB6aWctemFnIGxpa2UgYVxuICAgKiBgZmxleFdyYXBgIGxheW91dC4gSXRlbXMgc2hvdWxkIGFsbCBiZSB0aGUgc2FtZSBoZWlnaHQgLSBtYXNvbnJ5IGxheW91dHMgYXJlIG5vdCBzdXBwb3J0ZWQuXG4gICAqXG4gICAqIFRoZSBkZWZhdWx0IHZhbHVlIGlzIDEuXG4gICAqL1xuICBudW1Db2x1bW5zPzogbnVtYmVyLFxuICAvKipcbiAgICogTm90ZTogbWF5IGhhdmUgYnVncyAobWlzc2luZyBjb250ZW50KSBpbiBzb21lIGNpcmN1bXN0YW5jZXMgLSB1c2UgYXQgeW91ciBvd24gcmlzay5cbiAgICpcbiAgICogVGhpcyBtYXkgaW1wcm92ZSBzY3JvbGwgcGVyZm9ybWFuY2UgZm9yIGxhcmdlIGxpc3RzLlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlIGZvciBBbmRyb2lkLlxuICAgKi9cbiAgcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzPzogYm9vbGVhbixcbiAgLyoqXG4gICAqIFNlZSBgU2Nyb2xsVmlld2AgZm9yIGZsb3cgdHlwZSBhbmQgZnVydGhlciBkb2N1bWVudGF0aW9uLlxuICAgKi9cbiAgZmFkaW5nRWRnZUxlbmd0aD86ID9udW1iZXIsXG58fTtcblxuLyoqXG4gKiBEZWZhdWx0IFByb3BzIEhlbHBlciBGdW5jdGlvbnNcbiAqIFVzZSB0aGUgZm9sbG93aW5nIGhlbHBlciBmdW5jdGlvbnMgZm9yIGRlZmF1bHQgdmFsdWVzXG4gKi9cblxuLy8gcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzT3JEZWZhdWx0KHRoaXMucHJvcHMucmVtb3ZlQ2xpcHBlZFN1YnZpZXdzKVxuZnVuY3Rpb24gcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzT3JEZWZhdWx0KHJlbW92ZUNsaXBwZWRTdWJ2aWV3czogP2Jvb2xlYW4pIHtcbiAgcmV0dXJuIHJlbW92ZUNsaXBwZWRTdWJ2aWV3cyA/PyBQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnO1xufVxuXG4vLyBudW1Db2x1bW5zT3JEZWZhdWx0KHRoaXMucHJvcHMubnVtQ29sdW1ucylcbmZ1bmN0aW9uIG51bUNvbHVtbnNPckRlZmF1bHQobnVtQ29sdW1uczogP251bWJlcikge1xuICByZXR1cm4gbnVtQ29sdW1ucyA/PyAxO1xufVxuXG50eXBlIEZsYXRMaXN0UHJvcHM8SXRlbVQ+ID0ge3xcbiAgLi4uUmVxdWlyZWRQcm9wczxJdGVtVD4sXG4gIC4uLk9wdGlvbmFsUHJvcHM8SXRlbVQ+LFxufH07XG5cbnR5cGUgVmlydHVhbGl6ZWRMaXN0UHJvcHMgPSBSZWFjdC5FbGVtZW50Q29uZmlnPHR5cGVvZiBWaXJ0dWFsaXplZExpc3Q+O1xuXG5leHBvcnQgdHlwZSBQcm9wczxJdGVtVD4gPSB7XG4gIC4uLiREaWZmPFxuICAgIFZpcnR1YWxpemVkTGlzdFByb3BzLFxuICAgIHtcbiAgICAgIGdldEl0ZW06ICRQcm9wZXJ0eVR5cGU8VmlydHVhbGl6ZWRMaXN0UHJvcHMsICdnZXRJdGVtJz4sXG4gICAgICBnZXRJdGVtQ291bnQ6ICRQcm9wZXJ0eVR5cGU8VmlydHVhbGl6ZWRMaXN0UHJvcHMsICdnZXRJdGVtQ291bnQnPixcbiAgICAgIGdldEl0ZW1MYXlvdXQ6ICRQcm9wZXJ0eVR5cGU8VmlydHVhbGl6ZWRMaXN0UHJvcHMsICdnZXRJdGVtTGF5b3V0Jz4sXG4gICAgICByZW5kZXJJdGVtOiAkUHJvcGVydHlUeXBlPFZpcnR1YWxpemVkTGlzdFByb3BzLCAncmVuZGVySXRlbSc+LFxuICAgICAga2V5RXh0cmFjdG9yOiAkUHJvcGVydHlUeXBlPFZpcnR1YWxpemVkTGlzdFByb3BzLCAna2V5RXh0cmFjdG9yJz4sXG4gICAgICAuLi5cbiAgICB9LFxuICA+LFxuICAuLi5GbGF0TGlzdFByb3BzPEl0ZW1UPixcbiAgLi4uXG59O1xuXG4vKipcbiAqIEEgcGVyZm9ybWFudCBpbnRlcmZhY2UgZm9yIHJlbmRlcmluZyBzaW1wbGUsIGZsYXQgbGlzdHMsIHN1cHBvcnRpbmcgdGhlIG1vc3QgaGFuZHkgZmVhdHVyZXM6XG4gKlxuICogIC0gRnVsbHkgY3Jvc3MtcGxhdGZvcm0uXG4gKiAgLSBPcHRpb25hbCBob3Jpem9udGFsIG1vZGUuXG4gKiAgLSBDb25maWd1cmFibGUgdmlld2FiaWxpdHkgY2FsbGJhY2tzLlxuICogIC0gSGVhZGVyIHN1cHBvcnQuXG4gKiAgLSBGb290ZXIgc3VwcG9ydC5cbiAqICAtIFNlcGFyYXRvciBzdXBwb3J0LlxuICogIC0gUHVsbCB0byBSZWZyZXNoLlxuICogIC0gU2Nyb2xsIGxvYWRpbmcuXG4gKiAgLSBTY3JvbGxUb0luZGV4IHN1cHBvcnQuXG4gKlxuICogSWYgeW91IG5lZWQgc2VjdGlvbiBzdXBwb3J0LCB1c2UgW2A8U2VjdGlvbkxpc3Q+YF0oZG9jcy9zZWN0aW9ubGlzdC5odG1sKS5cbiAqXG4gKiBNaW5pbWFsIEV4YW1wbGU6XG4gKlxuICogICAgIDxGbGF0TGlzdFxuICogICAgICAgZGF0YT17W3trZXk6ICdhJ30sIHtrZXk6ICdiJ31dfVxuICogICAgICAgcmVuZGVySXRlbT17KHtpdGVtfSkgPT4gPFRleHQ+e2l0ZW0ua2V5fTwvVGV4dD59XG4gKiAgICAgLz5cbiAqXG4gKiBNb3JlIGNvbXBsZXgsIG11bHRpLXNlbGVjdCBleGFtcGxlIGRlbW9uc3RyYXRpbmcgYFB1cmVDb21wb25lbnRgIHVzYWdlIGZvciBwZXJmIG9wdGltaXphdGlvbiBhbmQgYXZvaWRpbmcgYnVncy5cbiAqXG4gKiAtIEJ5IGJpbmRpbmcgdGhlIGBvblByZXNzSXRlbWAgaGFuZGxlciwgdGhlIHByb3BzIHdpbGwgcmVtYWluIGA9PT1gIGFuZCBgUHVyZUNvbXBvbmVudGAgd2lsbFxuICogICBwcmV2ZW50IHdhc3RlZnVsIHJlLXJlbmRlcnMgdW5sZXNzIHRoZSBhY3R1YWwgYGlkYCwgYHNlbGVjdGVkYCwgb3IgYHRpdGxlYCBwcm9wcyBjaGFuZ2UsIGV2ZW5cbiAqICAgaWYgdGhlIGNvbXBvbmVudHMgcmVuZGVyZWQgaW4gYE15TGlzdEl0ZW1gIGRpZCBub3QgaGF2ZSBzdWNoIG9wdGltaXphdGlvbnMuXG4gKiAtIEJ5IHBhc3NpbmcgYGV4dHJhRGF0YT17dGhpcy5zdGF0ZX1gIHRvIGBGbGF0TGlzdGAgd2UgbWFrZSBzdXJlIGBGbGF0TGlzdGAgaXRzZWxmIHdpbGwgcmUtcmVuZGVyXG4gKiAgIHdoZW4gdGhlIGBzdGF0ZS5zZWxlY3RlZGAgY2hhbmdlcy4gV2l0aG91dCBzZXR0aW5nIHRoaXMgcHJvcCwgYEZsYXRMaXN0YCB3b3VsZCBub3Qga25vdyBpdFxuICogICBuZWVkcyB0byByZS1yZW5kZXIgYW55IGl0ZW1zIGJlY2F1c2UgaXQgaXMgYWxzbyBhIGBQdXJlQ29tcG9uZW50YCBhbmQgdGhlIHByb3AgY29tcGFyaXNvbiB3aWxsXG4gKiAgIG5vdCBzaG93IGFueSBjaGFuZ2VzLlxuICogLSBga2V5RXh0cmFjdG9yYCB0ZWxscyB0aGUgbGlzdCB0byB1c2UgdGhlIGBpZGBzIGZvciB0aGUgcmVhY3Qga2V5cyBpbnN0ZWFkIG9mIHRoZSBkZWZhdWx0IGBrZXlgIHByb3BlcnR5LlxuICpcbiAqXG4gKiAgICAgY2xhc3MgTXlMaXN0SXRlbSBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICogICAgICAgX29uUHJlc3MgPSAoKSA9PiB7XG4gKiAgICAgICAgIHRoaXMucHJvcHMub25QcmVzc0l0ZW0odGhpcy5wcm9wcy5pZCk7XG4gKiAgICAgICB9O1xuICpcbiAqICAgICAgIHJlbmRlcigpIHtcbiAqICAgICAgICAgY29uc3QgdGV4dENvbG9yID0gdGhpcy5wcm9wcy5zZWxlY3RlZCA/IFwicmVkXCIgOiBcImJsYWNrXCI7XG4gKiAgICAgICAgIHJldHVybiAoXG4gKiAgICAgICAgICAgPFRvdWNoYWJsZU9wYWNpdHkgb25QcmVzcz17dGhpcy5fb25QcmVzc30+XG4gKiAgICAgICAgICAgICA8Vmlldz5cbiAqICAgICAgICAgICAgICAgPFRleHQgc3R5bGU9e3sgY29sb3I6IHRleHRDb2xvciB9fT5cbiAqICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy50aXRsZX1cbiAqICAgICAgICAgICAgICAgPC9UZXh0PlxuICogICAgICAgICAgICAgPC9WaWV3PlxuICogICAgICAgICAgIDwvVG91Y2hhYmxlT3BhY2l0eT5cbiAqICAgICAgICAgKTtcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKlxuICogICAgIGNsYXNzIE11bHRpU2VsZWN0TGlzdCBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICogICAgICAgc3RhdGUgPSB7c2VsZWN0ZWQ6IChuZXcgTWFwKCk6IE1hcDxzdHJpbmcsIGJvb2xlYW4+KX07XG4gKlxuICogICAgICAgX2tleUV4dHJhY3RvciA9IChpdGVtLCBpbmRleCkgPT4gaXRlbS5pZDtcbiAqXG4gKiAgICAgICBfb25QcmVzc0l0ZW0gPSAoaWQ6IHN0cmluZykgPT4ge1xuICogICAgICAgICAvLyB1cGRhdGVyIGZ1bmN0aW9ucyBhcmUgcHJlZmVycmVkIGZvciB0cmFuc2FjdGlvbmFsIHVwZGF0ZXNcbiAqICAgICAgICAgdGhpcy5zZXRTdGF0ZSgoc3RhdGUpID0+IHtcbiAqICAgICAgICAgICAvLyBjb3B5IHRoZSBtYXAgcmF0aGVyIHRoYW4gbW9kaWZ5aW5nIHN0YXRlLlxuICogICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbmV3IE1hcChzdGF0ZS5zZWxlY3RlZCk7XG4gKiAgICAgICAgICAgc2VsZWN0ZWQuc2V0KGlkLCAhc2VsZWN0ZWQuZ2V0KGlkKSk7IC8vIHRvZ2dsZVxuICogICAgICAgICAgIHJldHVybiB7c2VsZWN0ZWR9O1xuICogICAgICAgICB9KTtcbiAqICAgICAgIH07XG4gKlxuICogICAgICAgX3JlbmRlckl0ZW0gPSAoe2l0ZW19KSA9PiAoXG4gKiAgICAgICAgIDxNeUxpc3RJdGVtXG4gKiAgICAgICAgICAgaWQ9e2l0ZW0uaWR9XG4gKiAgICAgICAgICAgb25QcmVzc0l0ZW09e3RoaXMuX29uUHJlc3NJdGVtfVxuICogICAgICAgICAgIHNlbGVjdGVkPXshIXRoaXMuc3RhdGUuc2VsZWN0ZWQuZ2V0KGl0ZW0uaWQpfVxuICogICAgICAgICAgIHRpdGxlPXtpdGVtLnRpdGxlfVxuICogICAgICAgICAvPlxuICogICAgICAgKTtcbiAqXG4gKiAgICAgICByZW5kZXIoKSB7XG4gKiAgICAgICAgIHJldHVybiAoXG4gKiAgICAgICAgICAgPEZsYXRMaXN0XG4gKiAgICAgICAgICAgICBkYXRhPXt0aGlzLnByb3BzLmRhdGF9XG4gKiAgICAgICAgICAgICBleHRyYURhdGE9e3RoaXMuc3RhdGV9XG4gKiAgICAgICAgICAgICBrZXlFeHRyYWN0b3I9e3RoaXMuX2tleUV4dHJhY3Rvcn1cbiAqICAgICAgICAgICAgIHJlbmRlckl0ZW09e3RoaXMuX3JlbmRlckl0ZW19XG4gKiAgICAgICAgICAgLz5cbiAqICAgICAgICAgKTtcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKlxuICogVGhpcyBpcyBhIGNvbnZlbmllbmNlIHdyYXBwZXIgYXJvdW5kIFtgPFZpcnR1YWxpemVkTGlzdD5gXShkb2NzL3ZpcnR1YWxpemVkbGlzdC5odG1sKSxcbiAqIGFuZCB0aHVzIGluaGVyaXRzIGl0cyBwcm9wcyAoYXMgd2VsbCBhcyB0aG9zZSBvZiBgU2Nyb2xsVmlld2ApIHRoYXQgYXJlbid0IGV4cGxpY2l0bHkgbGlzdGVkXG4gKiBoZXJlLCBhbG9uZyB3aXRoIHRoZSBmb2xsb3dpbmcgY2F2ZWF0czpcbiAqXG4gKiAtIEludGVybmFsIHN0YXRlIGlzIG5vdCBwcmVzZXJ2ZWQgd2hlbiBjb250ZW50IHNjcm9sbHMgb3V0IG9mIHRoZSByZW5kZXIgd2luZG93LiBNYWtlIHN1cmUgYWxsXG4gKiAgIHlvdXIgZGF0YSBpcyBjYXB0dXJlZCBpbiB0aGUgaXRlbSBkYXRhIG9yIGV4dGVybmFsIHN0b3JlcyBsaWtlIEZsdXgsIFJlZHV4LCBvciBSZWxheS5cbiAqIC0gVGhpcyBpcyBhIGBQdXJlQ29tcG9uZW50YCB3aGljaCBtZWFucyB0aGF0IGl0IHdpbGwgbm90IHJlLXJlbmRlciBpZiBgcHJvcHNgIHJlbWFpbiBzaGFsbG93LVxuICogICBlcXVhbC4gTWFrZSBzdXJlIHRoYXQgZXZlcnl0aGluZyB5b3VyIGByZW5kZXJJdGVtYCBmdW5jdGlvbiBkZXBlbmRzIG9uIGlzIHBhc3NlZCBhcyBhIHByb3BcbiAqICAgKGUuZy4gYGV4dHJhRGF0YWApIHRoYXQgaXMgbm90IGA9PT1gIGFmdGVyIHVwZGF0ZXMsIG90aGVyd2lzZSB5b3VyIFVJIG1heSBub3QgdXBkYXRlIG9uXG4gKiAgIGNoYW5nZXMuIFRoaXMgaW5jbHVkZXMgdGhlIGBkYXRhYCBwcm9wIGFuZCBwYXJlbnQgY29tcG9uZW50IHN0YXRlLlxuICogLSBJbiBvcmRlciB0byBjb25zdHJhaW4gbWVtb3J5IGFuZCBlbmFibGUgc21vb3RoIHNjcm9sbGluZywgY29udGVudCBpcyByZW5kZXJlZCBhc3luY2hyb25vdXNseVxuICogICBvZmZzY3JlZW4uIFRoaXMgbWVhbnMgaXQncyBwb3NzaWJsZSB0byBzY3JvbGwgZmFzdGVyIHRoYW4gdGhlIGZpbGwgcmF0ZSBhbmRzIG1vbWVudGFyaWx5IHNlZVxuICogICBibGFuayBjb250ZW50LiBUaGlzIGlzIGEgdHJhZGVvZmYgdGhhdCBjYW4gYmUgYWRqdXN0ZWQgdG8gc3VpdCB0aGUgbmVlZHMgb2YgZWFjaCBhcHBsaWNhdGlvbixcbiAqICAgYW5kIHdlIGFyZSB3b3JraW5nIG9uIGltcHJvdmluZyBpdCBiZWhpbmQgdGhlIHNjZW5lcy5cbiAqIC0gQnkgZGVmYXVsdCwgdGhlIGxpc3QgbG9va3MgZm9yIGEgYGtleWAgcHJvcCBvbiBlYWNoIGl0ZW0gYW5kIHVzZXMgdGhhdCBmb3IgdGhlIFJlYWN0IGtleS5cbiAqICAgQWx0ZXJuYXRpdmVseSwgeW91IGNhbiBwcm92aWRlIGEgY3VzdG9tIGBrZXlFeHRyYWN0b3JgIHByb3AuXG4gKlxuICogQWxzbyBpbmhlcml0cyBbU2Nyb2xsVmlldyBQcm9wc10oZG9jcy9zY3JvbGx2aWV3Lmh0bWwjcHJvcHMpLCB1bmxlc3MgaXQgaXMgbmVzdGVkIGluIGFub3RoZXIgRmxhdExpc3Qgb2Ygc2FtZSBvcmllbnRhdGlvbi5cbiAqL1xuY2xhc3MgRmxhdExpc3Q8SXRlbVQ+IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxQcm9wczxJdGVtVD4sIHZvaWQ+IHtcbiAgcHJvcHM6IFByb3BzPEl0ZW1UPjtcbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gdGhlIGVuZCBvZiB0aGUgY29udGVudC4gTWF5IGJlIGphbmt5IHdpdGhvdXQgYGdldEl0ZW1MYXlvdXRgIHByb3AuXG4gICAqL1xuICBzY3JvbGxUb0VuZChwYXJhbXM/OiA/e2FuaW1hdGVkPzogP2Jvb2xlYW4sIC4uLn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb0VuZChwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIHRoZSBpdGVtIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXggc3VjaCB0aGF0IGl0IGlzIHBvc2l0aW9uZWQgaW4gdGhlIHZpZXdhYmxlIGFyZWFcbiAgICogc3VjaCB0aGF0IGB2aWV3UG9zaXRpb25gIDAgcGxhY2VzIGl0IGF0IHRoZSB0b3AsIDEgYXQgdGhlIGJvdHRvbSwgYW5kIDAuNSBjZW50ZXJlZCBpbiB0aGVcbiAgICogbWlkZGxlLiBgdmlld09mZnNldGAgaXMgYSBmaXhlZCBudW1iZXIgb2YgcGl4ZWxzIHRvIG9mZnNldCB0aGUgZmluYWwgdGFyZ2V0IHBvc2l0aW9uLlxuICAgKlxuICAgKiBOb3RlOiBjYW5ub3Qgc2Nyb2xsIHRvIGxvY2F0aW9ucyBvdXRzaWRlIHRoZSByZW5kZXIgd2luZG93IHdpdGhvdXQgc3BlY2lmeWluZyB0aGVcbiAgICogYGdldEl0ZW1MYXlvdXRgIHByb3AuXG4gICAqL1xuICBzY3JvbGxUb0luZGV4KHBhcmFtczoge1xuICAgIGFuaW1hdGVkPzogP2Jvb2xlYW4sXG4gICAgaW5kZXg6IG51bWJlcixcbiAgICB2aWV3T2Zmc2V0PzogbnVtYmVyLFxuICAgIHZpZXdQb3NpdGlvbj86IG51bWJlcixcbiAgICAuLi5cbiAgfSkge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICB0aGlzLl9saXN0UmVmLnNjcm9sbFRvSW5kZXgocGFyYW1zKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVxdWlyZXMgbGluZWFyIHNjYW4gdGhyb3VnaCBkYXRhIC0gdXNlIGBzY3JvbGxUb0luZGV4YCBpbnN0ZWFkIGlmIHBvc3NpYmxlLlxuICAgKlxuICAgKiBOb3RlOiBjYW5ub3Qgc2Nyb2xsIHRvIGxvY2F0aW9ucyBvdXRzaWRlIHRoZSByZW5kZXIgd2luZG93IHdpdGhvdXQgc3BlY2lmeWluZyB0aGVcbiAgICogYGdldEl0ZW1MYXlvdXRgIHByb3AuXG4gICAqL1xuICBzY3JvbGxUb0l0ZW0ocGFyYW1zOiB7XG4gICAgYW5pbWF0ZWQ/OiA/Ym9vbGVhbixcbiAgICBpdGVtOiBJdGVtVCxcbiAgICB2aWV3UG9zaXRpb24/OiBudW1iZXIsXG4gICAgLi4uXG4gIH0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb0l0ZW0ocGFyYW1zKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xsIHRvIGEgc3BlY2lmaWMgY29udGVudCBwaXhlbCBvZmZzZXQgaW4gdGhlIGxpc3QuXG4gICAqXG4gICAqIENoZWNrIG91dCBbc2Nyb2xsVG9PZmZzZXRdKGRvY3MvdmlydHVhbGl6ZWRsaXN0Lmh0bWwjc2Nyb2xsdG9vZmZzZXQpIG9mIFZpcnR1YWxpemVkTGlzdFxuICAgKi9cbiAgc2Nyb2xsVG9PZmZzZXQocGFyYW1zOiB7YW5pbWF0ZWQ/OiA/Ym9vbGVhbiwgb2Zmc2V0OiBudW1iZXIsIC4uLn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb09mZnNldChwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUZWxscyB0aGUgbGlzdCBhbiBpbnRlcmFjdGlvbiBoYXMgb2NjdXJyZWQsIHdoaWNoIHNob3VsZCB0cmlnZ2VyIHZpZXdhYmlsaXR5IGNhbGN1bGF0aW9ucywgZS5nLlxuICAgKiBpZiBgd2FpdEZvckludGVyYWN0aW9uc2AgaXMgdHJ1ZSBhbmQgdGhlIHVzZXIgaGFzIG5vdCBzY3JvbGxlZC4gVGhpcyBpcyB0eXBpY2FsbHkgY2FsbGVkIGJ5XG4gICAqIHRhcHMgb24gaXRlbXMgb3IgYnkgbmF2aWdhdGlvbiBhY3Rpb25zLlxuICAgKi9cbiAgcmVjb3JkSW50ZXJhY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYucmVjb3JkSW50ZXJhY3Rpb24oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheXMgdGhlIHNjcm9sbCBpbmRpY2F0b3JzIG1vbWVudGFyaWx5LlxuICAgKlxuICAgKiBAcGxhdGZvcm0gaW9zXG4gICAqL1xuICBmbGFzaFNjcm9sbEluZGljYXRvcnMoKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYuZmxhc2hTY3JvbGxJbmRpY2F0b3JzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEgaGFuZGxlIHRvIHRoZSB1bmRlcmx5aW5nIHNjcm9sbCByZXNwb25kZXIuXG4gICAqL1xuICBnZXRTY3JvbGxSZXNwb25kZXIoKTogP1Njcm9sbFJlc3BvbmRlclR5cGUge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGlzdFJlZi5nZXRTY3JvbGxSZXNwb25kZXIoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgYSByZWZlcmVuY2UgdG8gdGhlIHVuZGVybHlpbmcgaG9zdCBjb21wb25lbnRcbiAgICovXG4gIGdldE5hdGl2ZVNjcm9sbFJlZigpOlxuICAgIHwgP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFZpZXc+XG4gICAgfCA/UmVhY3QuRWxlbWVudFJlZjxTY3JvbGxWaWV3TmF0aXZlQ29tcG9uZW50PiB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl0gU3VwcHJlc3NlcyBlcnJvcnMgZm91bmQgd2hlbiBmaXhpbmdcbiAgICAgICAqIFRleHRJbnB1dCB0eXBpbmcgKi9cbiAgICAgIHJldHVybiB0aGlzLl9saXN0UmVmLmdldFNjcm9sbFJlZigpO1xuICAgIH1cbiAgfVxuXG4gIGdldFNjcm9sbGFibGVOb2RlKCk6IGFueSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHJldHVybiB0aGlzLl9saXN0UmVmLmdldFNjcm9sbGFibGVOb2RlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0TmF0aXZlUHJvcHMocHJvcHM6IHtbc3RyaW5nXTogbWl4ZWQsIC4uLn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zZXROYXRpdmVQcm9wcyhwcm9wcyk7XG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzPEl0ZW1UPikge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLl9jaGVja1Byb3BzKHRoaXMucHJvcHMpO1xuICAgIGlmICh0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycykge1xuICAgICAgdGhpcy5fdmlydHVhbGl6ZWRMaXN0UGFpcnMgPVxuICAgICAgICB0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycy5tYXAocGFpciA9PiAoe1xuICAgICAgICAgIHZpZXdhYmlsaXR5Q29uZmlnOiBwYWlyLnZpZXdhYmlsaXR5Q29uZmlnLFxuICAgICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6IHRoaXMuX2NyZWF0ZU9uVmlld2FibGVJdGVtc0NoYW5nZWQoXG4gICAgICAgICAgICBwYWlyLm9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgICAgKSxcbiAgICAgICAgfSkpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkKSB7XG4gICAgICB0aGlzLl92aXJ0dWFsaXplZExpc3RQYWlycy5wdXNoKHtcbiAgICAgICAgLyogJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF0gKD49MC42My4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKSBUaGlzXG4gICAgICAgICAqIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuNjMgd2FzIGRlcGxveWVkLiBUb1xuICAgICAgICAgKiBzZWUgdGhlIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgICB2aWV3YWJpbGl0eUNvbmZpZzogdGhpcy5wcm9wcy52aWV3YWJpbGl0eUNvbmZpZyxcbiAgICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZDogdGhpcy5fY3JlYXRlT25WaWV3YWJsZUl0ZW1zQ2hhbmdlZChcbiAgICAgICAgICB0aGlzLnByb3BzLm9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgICksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBQcm9wczxJdGVtVD4pIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBwcmV2UHJvcHMubnVtQ29sdW1ucyA9PT0gdGhpcy5wcm9wcy5udW1Db2x1bW5zLFxuICAgICAgJ0NoYW5naW5nIG51bUNvbHVtbnMgb24gdGhlIGZseSBpcyBub3Qgc3VwcG9ydGVkLiBDaGFuZ2UgdGhlIGtleSBwcm9wIG9uIEZsYXRMaXN0IHdoZW4gJyArXG4gICAgICAgICdjaGFuZ2luZyB0aGUgbnVtYmVyIG9mIGNvbHVtbnMgdG8gZm9yY2UgYSBmcmVzaCByZW5kZXIgb2YgdGhlIGNvbXBvbmVudC4nLFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgcHJldlByb3BzLm9uVmlld2FibGVJdGVtc0NoYW5nZWQgPT09IHRoaXMucHJvcHMub25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCxcbiAgICAgICdDaGFuZ2luZyBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkIG9uIHRoZSBmbHkgaXMgbm90IHN1cHBvcnRlZCcsXG4gICAgKTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICAhZGVlcERpZmZlcihwcmV2UHJvcHMudmlld2FiaWxpdHlDb25maWcsIHRoaXMucHJvcHMudmlld2FiaWxpdHlDb25maWcpLFxuICAgICAgJ0NoYW5naW5nIHZpZXdhYmlsaXR5Q29uZmlnIG9uIHRoZSBmbHkgaXMgbm90IHN1cHBvcnRlZCcsXG4gICAgKTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBwcmV2UHJvcHMudmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzID09PVxuICAgICAgICB0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyxcbiAgICAgICdDaGFuZ2luZyB2aWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcnMgb24gdGhlIGZseSBpcyBub3Qgc3VwcG9ydGVkJyxcbiAgICApO1xuXG4gICAgdGhpcy5fY2hlY2tQcm9wcyh0aGlzLnByb3BzKTtcbiAgfVxuXG4gIF9saXN0UmVmOiA/UmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgVmlydHVhbGl6ZWRMaXN0PjtcbiAgX3ZpcnR1YWxpemVkTGlzdFBhaXJzOiBBcnJheTxWaWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcj4gPSBbXTtcblxuICBfY2FwdHVyZVJlZiA9IHJlZiA9PiB7XG4gICAgdGhpcy5fbGlzdFJlZiA9IHJlZjtcbiAgfTtcblxuICBfY2hlY2tQcm9wcyhwcm9wczogUHJvcHM8SXRlbVQ+KSB7XG4gICAgY29uc3Qge1xuICAgICAgLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddIHRoaXMgcHJvcCBkb2Vzbid0IGV4aXN0LCBpcyBvbmx5IHVzZWQgZm9yIGFuIGludmFyaWFudFxuICAgICAgZ2V0SXRlbSxcbiAgICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSB0aGlzIHByb3AgZG9lc24ndCBleGlzdCwgaXMgb25seSB1c2VkIGZvciBhbiBpbnZhcmlhbnRcbiAgICAgIGdldEl0ZW1Db3VudCxcbiAgICAgIGhvcml6b250YWwsXG4gICAgICBjb2x1bW5XcmFwcGVyU3R5bGUsXG4gICAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkLFxuICAgICAgdmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzLFxuICAgIH0gPSBwcm9wcztcbiAgICBjb25zdCBudW1Db2x1bW5zID0gbnVtQ29sdW1uc09yRGVmYXVsdCh0aGlzLnByb3BzLm51bUNvbHVtbnMpO1xuICAgIGludmFyaWFudChcbiAgICAgICFnZXRJdGVtICYmICFnZXRJdGVtQ291bnQsXG4gICAgICAnRmxhdExpc3QgZG9lcyBub3Qgc3VwcG9ydCBjdXN0b20gZGF0YSBmb3JtYXRzLicsXG4gICAgKTtcbiAgICBpZiAobnVtQ29sdW1ucyA+IDEpIHtcbiAgICAgIGludmFyaWFudCghaG9yaXpvbnRhbCwgJ251bUNvbHVtbnMgZG9lcyBub3Qgc3VwcG9ydCBob3Jpem9udGFsLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgICFjb2x1bW5XcmFwcGVyU3R5bGUsXG4gICAgICAgICdjb2x1bW5XcmFwcGVyU3R5bGUgbm90IHN1cHBvcnRlZCBmb3Igc2luZ2xlIGNvbHVtbiBsaXN0cycsXG4gICAgICApO1xuICAgIH1cbiAgICBpbnZhcmlhbnQoXG4gICAgICAhKG9uVmlld2FibGVJdGVtc0NoYW5nZWQgJiYgdmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzKSxcbiAgICAgICdGbGF0TGlzdCBkb2VzIG5vdCBzdXBwb3J0IHNldHRpbmcgYm90aCBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkIGFuZCAnICtcbiAgICAgICAgJ3ZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycy4nLFxuICAgICk7XG4gIH1cblxuICBfZ2V0SXRlbSA9IChkYXRhOiBBcnJheTxJdGVtVD4sIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICBjb25zdCBudW1Db2x1bW5zID0gbnVtQ29sdW1uc09yRGVmYXVsdCh0aGlzLnByb3BzLm51bUNvbHVtbnMpO1xuICAgIGlmIChudW1Db2x1bW5zID4gMSkge1xuICAgICAgY29uc3QgcmV0ID0gW107XG4gICAgICBmb3IgKGxldCBrayA9IDA7IGtrIDwgbnVtQ29sdW1uczsga2srKykge1xuICAgICAgICBjb25zdCBpdGVtID0gZGF0YVtpbmRleCAqIG51bUNvbHVtbnMgKyBra107XG4gICAgICAgIGlmIChpdGVtICE9IG51bGwpIHtcbiAgICAgICAgICByZXQucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGRhdGFbaW5kZXhdO1xuICAgIH1cbiAgfTtcblxuICBfZ2V0SXRlbUNvdW50ID0gKGRhdGE6ID9BcnJheTxJdGVtVD4pOiBudW1iZXIgPT4ge1xuICAgIGlmIChkYXRhKSB7XG4gICAgICBjb25zdCBudW1Db2x1bW5zID0gbnVtQ29sdW1uc09yRGVmYXVsdCh0aGlzLnByb3BzLm51bUNvbHVtbnMpO1xuICAgICAgcmV0dXJuIG51bUNvbHVtbnMgPiAxID8gTWF0aC5jZWlsKGRhdGEubGVuZ3RoIC8gbnVtQ29sdW1ucykgOiBkYXRhLmxlbmd0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9O1xuXG4gIF9rZXlFeHRyYWN0b3IgPSAoaXRlbXM6IEl0ZW1UIHwgQXJyYXk8SXRlbVQ+LCBpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgbnVtQ29sdW1ucyA9IG51bUNvbHVtbnNPckRlZmF1bHQodGhpcy5wcm9wcy5udW1Db2x1bW5zKTtcbiAgICBjb25zdCBrZXlFeHRyYWN0b3IgPSB0aGlzLnByb3BzLmtleUV4dHJhY3RvciA/PyBkZWZhdWx0S2V5RXh0cmFjdG9yO1xuXG4gICAgaWYgKG51bUNvbHVtbnMgPiAxKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtcykpIHtcbiAgICAgICAgcmV0dXJuIGl0ZW1zXG4gICAgICAgICAgLm1hcCgoaXRlbSwga2spID0+XG4gICAgICAgICAgICBrZXlFeHRyYWN0b3IoKChpdGVtOiAkRmxvd0ZpeE1lKTogSXRlbVQpLCBpbmRleCAqIG51bUNvbHVtbnMgKyBrayksXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCc6Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnZhcmlhbnQoXG4gICAgICAgICAgQXJyYXkuaXNBcnJheShpdGVtcyksXG4gICAgICAgICAgJ0ZsYXRMaXN0OiBFbmNvdW50ZXJlZCBpbnRlcm5hbCBjb25zaXN0ZW5jeSBlcnJvciwgZXhwZWN0ZWQgZWFjaCBpdGVtIHRvIGNvbnNpc3Qgb2YgYW4gJyArXG4gICAgICAgICAgICAnYXJyYXkgd2l0aCAxLSVzIGNvbHVtbnM7IGluc3RlYWQsIHJlY2VpdmVkIGEgc2luZ2xlIGl0ZW0uJyxcbiAgICAgICAgICBudW1Db2x1bW5zLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXSBDYW4ndCBjYWxsIGtleUV4dHJhY3RvciB3aXRoIGFuIGFycmF5XG4gICAgICByZXR1cm4ga2V5RXh0cmFjdG9yKGl0ZW1zLCBpbmRleCk7XG4gICAgfVxuICB9O1xuXG4gIF9wdXNoTXVsdGlDb2x1bW5WaWV3YWJsZShhcnI6IEFycmF5PFZpZXdUb2tlbj4sIHY6IFZpZXdUb2tlbik6IHZvaWQge1xuICAgIGNvbnN0IG51bUNvbHVtbnMgPSBudW1Db2x1bW5zT3JEZWZhdWx0KHRoaXMucHJvcHMubnVtQ29sdW1ucyk7XG4gICAgY29uc3Qga2V5RXh0cmFjdG9yID0gdGhpcy5wcm9wcy5rZXlFeHRyYWN0b3IgPz8gZGVmYXVsdEtleUV4dHJhY3RvcjtcbiAgICB2Lml0ZW0uZm9yRWFjaCgoaXRlbSwgaWkpID0+IHtcbiAgICAgIGludmFyaWFudCh2LmluZGV4ICE9IG51bGwsICdNaXNzaW5nIGluZGV4IScpO1xuICAgICAgY29uc3QgaW5kZXggPSB2LmluZGV4ICogbnVtQ29sdW1ucyArIGlpO1xuICAgICAgYXJyLnB1c2goey4uLnYsIGl0ZW0sIGtleToga2V5RXh0cmFjdG9yKGl0ZW0sIGluZGV4KSwgaW5kZXh9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9jcmVhdGVPblZpZXdhYmxlSXRlbXNDaGFuZ2VkKFxuICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6ID8oaW5mbzoge1xuICAgICAgdmlld2FibGVJdGVtczogQXJyYXk8Vmlld1Rva2VuPixcbiAgICAgIGNoYW5nZWQ6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICAuLi5cbiAgICB9KSA9PiB2b2lkLFxuICApIHtcbiAgICByZXR1cm4gKGluZm86IHtcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgICAgLi4uXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgbnVtQ29sdW1ucyA9IG51bUNvbHVtbnNPckRlZmF1bHQodGhpcy5wcm9wcy5udW1Db2x1bW5zKTtcbiAgICAgIGlmIChvblZpZXdhYmxlSXRlbXNDaGFuZ2VkKSB7XG4gICAgICAgIGlmIChudW1Db2x1bW5zID4gMSkge1xuICAgICAgICAgIGNvbnN0IGNoYW5nZWQgPSBbXTtcbiAgICAgICAgICBjb25zdCB2aWV3YWJsZUl0ZW1zID0gW107XG4gICAgICAgICAgaW5mby52aWV3YWJsZUl0ZW1zLmZvckVhY2godiA9PlxuICAgICAgICAgICAgdGhpcy5fcHVzaE11bHRpQ29sdW1uVmlld2FibGUodmlld2FibGVJdGVtcywgdiksXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpbmZvLmNoYW5nZWQuZm9yRWFjaCh2ID0+IHRoaXMuX3B1c2hNdWx0aUNvbHVtblZpZXdhYmxlKGNoYW5nZWQsIHYpKTtcbiAgICAgICAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkKHt2aWV3YWJsZUl0ZW1zLCBjaGFuZ2VkfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZChpbmZvKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBfcmVuZGVyZXIgPSAoKSA9PiB7XG4gICAgY29uc3Qge0xpc3RJdGVtQ29tcG9uZW50LCByZW5kZXJJdGVtLCBjb2x1bW5XcmFwcGVyU3R5bGV9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBudW1Db2x1bW5zID0gbnVtQ29sdW1uc09yRGVmYXVsdCh0aGlzLnByb3BzLm51bUNvbHVtbnMpO1xuXG4gICAgbGV0IHZpcnR1YWxpemVkTGlzdFJlbmRlcktleSA9IExpc3RJdGVtQ29tcG9uZW50XG4gICAgICA/ICdMaXN0SXRlbUNvbXBvbmVudCdcbiAgICAgIDogJ3JlbmRlckl0ZW0nO1xuXG4gICAgY29uc3QgcmVuZGVyZXIgPSAocHJvcHMpOiBSZWFjdC5Ob2RlID0+IHtcbiAgICAgIGlmIChMaXN0SXRlbUNvbXBvbmVudCkge1xuICAgICAgICAvLyAkRmxvd0ZpeE1lW25vdC1hLWNvbXBvbmVudF0gQ29tcG9uZW50IGlzbid0IHZhbGlkXG4gICAgICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXR5cGUtYXJnXSBDb21wb25lbnQgaXNuJ3QgdmFsaWRcbiAgICAgICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXSBDb21wb25lbnQgaXNuJ3QgdmFsaWRcbiAgICAgICAgcmV0dXJuIDxMaXN0SXRlbUNvbXBvbmVudCB7Li4ucHJvcHN9IC8+O1xuICAgICAgfSBlbHNlIGlmIChyZW5kZXJJdGVtKSB7XG4gICAgICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdXG4gICAgICAgIHJldHVybiByZW5kZXJJdGVtKHByb3BzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgLyogJEZsb3dGaXhNZVtpbnZhbGlkLWNvbXB1dGVkLXByb3BdICg+PTAuMTExLjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpXG4gICAgICAgKiBUaGlzIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuMTExIHdhcyBkZXBsb3llZC5cbiAgICAgICAqIFRvIHNlZSB0aGUgZXJyb3IsIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgW3ZpcnR1YWxpemVkTGlzdFJlbmRlcktleV06IChpbmZvOiBSZW5kZXJJdGVtUHJvcHM8SXRlbVQ+KSA9PiB7XG4gICAgICAgIGlmIChudW1Db2x1bW5zID4gMSkge1xuICAgICAgICAgIGNvbnN0IHtpdGVtLCBpbmRleH0gPSBpbmZvO1xuICAgICAgICAgIGludmFyaWFudChcbiAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoaXRlbSksXG4gICAgICAgICAgICAnRXhwZWN0ZWQgYXJyYXkgb2YgaXRlbXMgd2l0aCBudW1Db2x1bW5zID4gMScsXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFZpZXcgc3R5bGU9e1N0eWxlU2hlZXQuY29tcG9zZShzdHlsZXMucm93LCBjb2x1bW5XcmFwcGVyU3R5bGUpfT5cbiAgICAgICAgICAgICAge2l0ZW0ubWFwKChpdCwga2spID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gcmVuZGVyZXIoe1xuICAgICAgICAgICAgICAgICAgaXRlbTogaXQsXG4gICAgICAgICAgICAgICAgICBpbmRleDogaW5kZXggKiBudW1Db2x1bW5zICsga2ssXG4gICAgICAgICAgICAgICAgICBzZXBhcmF0b3JzOiBpbmZvLnNlcGFyYXRvcnMsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQgIT0gbnVsbCA/IChcbiAgICAgICAgICAgICAgICAgIDxSZWFjdC5GcmFnbWVudCBrZXk9e2trfT57ZWxlbWVudH08L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgICkgOiBudWxsO1xuICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvVmlldz5cbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiByZW5kZXJlcihpbmZvKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9O1xuICB9O1xuXG4gIHJlbmRlcigpOiBSZWFjdC5Ob2RlIHtcbiAgICBjb25zdCB7XG4gICAgICBudW1Db2x1bW5zLFxuICAgICAgY29sdW1uV3JhcHBlclN0eWxlLFxuICAgICAgcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzOiBfcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzLFxuICAgICAgLi4ucmVzdFByb3BzXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpcnR1YWxpemVkTGlzdFxuICAgICAgICB7Li4ucmVzdFByb3BzfVxuICAgICAgICBnZXRJdGVtPXt0aGlzLl9nZXRJdGVtfVxuICAgICAgICBnZXRJdGVtQ291bnQ9e3RoaXMuX2dldEl0ZW1Db3VudH1cbiAgICAgICAga2V5RXh0cmFjdG9yPXt0aGlzLl9rZXlFeHRyYWN0b3J9XG4gICAgICAgIHJlZj17dGhpcy5fY2FwdHVyZVJlZn1cbiAgICAgICAgdmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzPXt0aGlzLl92aXJ0dWFsaXplZExpc3RQYWlyc31cbiAgICAgICAgcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzPXtyZW1vdmVDbGlwcGVkU3Vidmlld3NPckRlZmF1bHQoXG4gICAgICAgICAgX3JlbW92ZUNsaXBwZWRTdWJ2aWV3cyxcbiAgICAgICAgKX1cbiAgICAgICAgey4uLnRoaXMuX3JlbmRlcmVyKCl9XG4gICAgICAvPlxuICAgICk7XG4gIH1cbn1cblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICByb3c6IHtmbGV4RGlyZWN0aW9uOiAncm93J30sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBGbGF0TGlzdDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQTJCQTs7Ozs7Ozs7Ozs7Ozs7QUFqQkEsSUFBTUEsUUFBUSxHQUFHQyxPQUFPLHlCQUF4Qjs7QUFDQSxJQUFNQyxVQUFVLEdBQUdELE9BQU8sa0NBQTFCOztBQUNBLElBQU1FLEtBQUssR0FBR0YsT0FBTyxDQUFDLE9BQUQsQ0FBckI7O0FBQ0EsSUFBTUcsSUFBSSxHQUFHSCxPQUFPLDJCQUFwQjs7QUFDQSxJQUFNSSxlQUFlLEdBQUdKLE9BQU8scUJBQS9COztBQUNBLElBQU1LLFVBQVUsR0FBR0wsT0FBTyw0QkFBMUI7O0FBRUEsSUFBTU0sU0FBUyxHQUFHTixPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFzSUEsU0FBU08sOEJBQVQsQ0FBd0NDLHFCQUF4QyxFQUF5RTtFQUN2RSxPQUFPQSxxQkFBUCxXQUFPQSxxQkFBUCxHQUFnQ1QsUUFBUSxDQUFDVSxFQUFULEtBQWdCLFNBQWhEO0FBQ0Q7O0FBR0QsU0FBU0MsbUJBQVQsQ0FBNkJDLFVBQTdCLEVBQWtEO0VBQ2hELE9BQU9BLFVBQVAsV0FBT0EsVUFBUCxHQUFxQixDQUFyQjtBQUNEOztJQXFJS0MsUTs7Ozs7RUFtSEosa0JBQVlDLE1BQVosRUFBaUM7SUFBQTs7SUFBQTtJQUMvQiwwQkFBTUEsTUFBTjtJQUQrQixNQWdEakNDLHFCQWhEaUMsR0FnRDZCLEVBaEQ3Qjs7SUFBQSxNQWtEakNDLFdBbERpQyxHQWtEbkIsVUFBQUMsR0FBRyxFQUFJO01BQ25CLE1BQUtDLFFBQUwsR0FBZ0JELEdBQWhCO0lBQ0QsQ0FwRGdDOztJQUFBLE1BcUZqQ0UsUUFyRmlDLEdBcUZ0QixVQUFDQyxJQUFELEVBQXFCQyxLQUFyQixFQUF1QztNQUNoRCxJQUFNVCxVQUFVLEdBQUdELG1CQUFtQixDQUFD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